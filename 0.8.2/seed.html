<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Seeding &mdash; MapProxy v0.8.2 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '0.8.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="MapProxy v0.8.2 documentation" href="index.html" />
    <link rel="next" title="Deployment" href="deployment.html" />
    <link rel="prev" title="Configuration" href="configuration.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="deployment.html" title="Deployment"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">MapProxy v0.8.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="seeding">
<h1>Seeding<a class="headerlink" href="#seeding" title="Permalink to this headline">¶</a></h1>
<p>The MapProxy creates all tiles on demand. To improve the performance for commonly
requested views it is possible to pre-generate these tiles. The <tt class="docutils literal"><span class="pre">proxy_seed</span></tt> script does
this task.</p>
<div class="section" id="proxy-seed">
<h2>proxy_seed<a class="headerlink" href="#proxy-seed" title="Permalink to this headline">¶</a></h2>
<p>The command line script expects a seed configuration that describes which tiles from which layer should be generated. See <a class="reference internal" href="#configuration">configuration</a> for the format of the file.</p>
<p>Use the <tt class="docutils literal"><span class="pre">-f</span></tt> option to specify the proxy configuration.</p>
<div class="highlight-python"><pre>proxy_seed -f etc/proxy.yaml etc/seed.yaml</pre>
</div>
<div class="section" id="rebuild">
<h3>rebuild<a class="headerlink" href="#rebuild" title="Permalink to this headline">¶</a></h3>
<p>The script checks if the requested tiles are present. If they are not cached, they will be
created. If the seed is configured with an <tt class="docutils literal"><span class="pre">remove_before</span></tt> date, the tile will be
recreated if it is older.</p>
<p>If you want to rebuild the cache, you can use the <tt class="docutils literal"><span class="pre">-r</span></tt> (<tt class="docutils literal"><span class="pre">--rebuild</span></tt>) option. It will
rebuild level per level. It first creates the new tiles for this level, then changes the
old ones with the new tiles and only removes the old tiles afterwards. That way the cache
is always present. The rebuild level will contain an <tt class="docutils literal"><span class="pre">last_seed</span></tt> file with the
time-stamp of the last rebuild. If there is a <cite>remove_before</cite> date configured, the level
will only be rebuild if the <tt class="docutils literal"><span class="pre">last_seed</span></tt> file is older than the date.</p>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The configuration contains two keys: <tt class="docutils literal"><span class="pre">views</span></tt> and <tt class="docutils literal"><span class="pre">seeds</span></tt>. <tt class="docutils literal"><span class="pre">views</span></tt> describes
geographical extends that should be seeded. <tt class="docutils literal"><span class="pre">seeds</span></tt> links actual layers with
those <tt class="docutils literal"><span class="pre">views</span></tt>.</p>
<div class="section" id="seeds">
<h3><tt class="docutils literal"><span class="pre">seeds</span></tt><a class="headerlink" href="#seeds" title="Permalink to this headline">¶</a></h3>
<p>Contains a dictionary with layer/view mapping.:</p>
<div class="highlight-python"><pre>seeds:
    cache1:
        views: ['world', 'germany', 'oldb']
    cache2:
        views: ['world', 'germany']
        remove_before:
            time: '2009-04-01T14:45:00'
            # or
            minutes: 15
            hours: 4
            days: 9
            weeks: 8</pre>
</div>
<dl class="docutils">
<dt><cite>remove_before</cite>:</dt>
<dd><p class="first">If present, recreate tiles if they are older than the date or time delta. Also, tiles
that are older will be removed. If you use the <tt class="docutils literal"><span class="pre">--rebuild</span></tt> option, the level will
only be recreated if the <tt class="docutils literal"><span class="pre">last_seed</span></tt> file in the level directory is older. If there
is no such file, the level will be rebuilt.</p>
<p class="last">You can either define a fixed time or a time delta. The <cite>time</cite> is a ISO-like date
string (no time-zones, no abbreviations). To define time delta use one or more
<cite>minutes</cite>, <cite>hours</cite>, <cite>days</cite>, <cite>weeks</cite> entries.</p>
</dd>
</dl>
</div>
<div class="section" id="views">
<h3><tt class="docutils literal"><span class="pre">views</span></tt><a class="headerlink" href="#views" title="Permalink to this headline">¶</a></h3>
<p>Contains a dictionary with all views. Each view describes a geographical extend.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">bbox</span></tt>:</dt>
<dd>The BBOX that should be cached. If omitted, the whole BBOX of the layer is used.</dd>
<dt><tt class="docutils literal"><span class="pre">bbox_srs</span></tt>:</dt>
<dd>The SRS of the BBOX. If omitted the SRS of the first layer cache is used.</dd>
<dt><tt class="docutils literal"><span class="pre">srs</span></tt>:</dt>
<dd>A list with SRS. If the layer contains caches for multiple SRS, only the caches
that match one of the SRS in this list will be seeded.</dd>
<dt><tt class="docutils literal"><span class="pre">res</span></tt>:</dt>
<dd>Seed until this resolution is cached.</dd>
</dl>
<p>or</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">level</span></tt>:</dt>
<dd>A number until which this layer is cached, or a tuple with a range of
levels that should be cached.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><pre>views:
    world: # cache whole layer from level 0 to 3
        level: 3
    germany: # seed a fixed bbox, from level 4 to 10
        bbox:  [5.40731, 46.8447, 15.5072, 55.4314]
        bbox_srs: EPSG:4326
        level: (4, 10)
    oldb: # seed around bbox until resolution of 4m/px
        bbox: [904500, 7000800, 925700, 7020400]
        bbox_srs: EPSG:900913
        srs: ['EPSG:4326', 'EPSG:900913']
        res: 4</pre>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">Seeding</a><ul>
<li><a class="reference external" href="#proxy-seed">proxy_seed</a><ul>
<li><a class="reference external" href="#rebuild">rebuild</a></li>
</ul>
</li>
<li><a class="reference external" href="#configuration">Configuration</a><ul>
<li><a class="reference external" href="#seeds"><tt class="docutils literal"><span class="pre">seeds</span></tt></a></li>
<li><a class="reference external" href="#views"><tt class="docutils literal"><span class="pre">views</span></tt></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="configuration.html"
                                  title="previous chapter">Configuration</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="deployment.html"
                                  title="next chapter">Deployment</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/seed.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="deployment.html" title="Deployment"
             >next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             >previous</a> |</li>
        <li><a href="index.html">MapProxy v0.8.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Oliver Tonnhofer, Omniscale.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.5.
    </div>
  </body>
</html>